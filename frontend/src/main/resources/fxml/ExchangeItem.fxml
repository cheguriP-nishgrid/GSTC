<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<!-- Main container: HBox to hold two large panels side-by-side -->
<HBox xmlns:fx="http://javafx.com/fxml" fx:controller="org.nishgrid.clienterp.controller.ExchangeItemController" spacing="20" style="-fx-background-color: #f7f9fc;">
    <padding>
        <Insets top="30" right="30" bottom="30" left="30"/>
    </padding>

    <!-- 1. Exchange Form Panel (VBox) -->
    <VBox spacing="15" HBox.hgrow="ALWAYS" maxWidth="350" minWidth="300" style="-fx-background-color: #ffffff; -fx-padding: 20; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 5);">
        <Label text="Exchange Item Form" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #333366;"/>

        <!-- GridPane for Form Fields (Label on left, Input on right) -->
        <GridPane hgap="15" vgap="12">
            <!-- Define Column Constraints:
                 Column 0 (Labels) is fixed/prefers its size.
                 Column 1 (Inputs) takes up all remaining space. -->
            <columnConstraints>
                <ColumnConstraints hgrow="NEVER" minWidth="100"/>
                <ColumnConstraints hgrow="ALWAYS" minWidth="150"/>
            </columnConstraints>

            <!-- Row 0: Customer -->
            <Label text="Customer:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
            <ComboBox fx:id="customerComboBox" maxWidth="Infinity" GridPane.rowIndex="0" GridPane.columnIndex="1" />

            <!-- Row 1: Original Invoice -->
            <Label text="Original Invoice:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
            <ComboBox fx:id="invoiceComboBox" maxWidth="Infinity" GridPane.rowIndex="1" GridPane.columnIndex="1" />

            <!-- Row 2: Item to Return -->
            <Label text="Item to Return:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
            <ComboBox fx:id="returnItemComboBox" maxWidth="Infinity" GridPane.rowIndex="2" GridPane.columnIndex="1" />

            <!-- Row 3: New Item -->
            <Label text="New Item:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
            <ComboBox fx:id="newItemComboBox" maxWidth="Infinity" GridPane.rowIndex="3" GridPane.columnIndex="1" />

            <!-- Row 4: Difference Amount -->
            <Label text="Difference Amount:" GridPane.rowIndex="4" GridPane.columnIndex="0"/>
            <Spinner fx:id="differenceAmountSpinner" maxWidth="Infinity" GridPane.rowIndex="4" GridPane.columnIndex="1" />

            <!-- Row 5: Exchange Date -->
            <Label text="Exchange Date:" GridPane.rowIndex="5" GridPane.columnIndex="0"/>
            <DatePicker fx:id="exchangeDatePicker" maxWidth="Infinity" GridPane.rowIndex="5" GridPane.columnIndex="1" />

            <!-- Row 6 & 7: Remarks (Label spans, TextArea spans) -->
            <Label text="Remarks:" GridPane.rowIndex="6" GridPane.columnIndex="0" GridPane.columnSpan="2"/>
            <TextArea fx:id="remarksArea" prefRowCount="3" maxWidth="Infinity" GridPane.rowIndex="7" GridPane.columnIndex="0" GridPane.columnSpan="2"/>

            <!-- Row 8: Handled By -->
            <Label text="Handled By:" GridPane.rowIndex="8" GridPane.columnIndex="0"/>
            <TextField fx:id="handledByField" maxWidth="Infinity" GridPane.rowIndex="8" GridPane.columnIndex="1" />
        </GridPane>

        <Button fx:id="submitButton" text="Submit Exchange" style="-fx-background-color: #5cb85c; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 8 15; -fx-background-radius: 6;" alignment="CENTER_RIGHT"/>
    </VBox>

    <!-- 2. Exchange Log Panel (VBox) -->
    <VBox spacing="15" HBox.hgrow="ALWAYS" style="-fx-background-color: #ffffff; -fx-padding: 20; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 5);">
        <Label text="Exchange Log" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #333366;"/>

        <!-- Search Bar (HBox) - TextField grows, Dates/Buttons are fixed -->
        <HBox spacing="10" alignment="CENTER_LEFT">
            <Label text="Filter:"/>
            <TextField fx:id="searchTextField" promptText="Invoice ID or Name" HBox.hgrow="ALWAYS"/>
            <Label text="From:"/>
            <DatePicker fx:id="startDatePicker" prefWidth="120"/>
            <Label text="To:"/>
            <DatePicker fx:id="endDatePicker" prefWidth="120"/>
            <Button text="Search" onAction="#handleSearch" style="-fx-background-color: #007bff; -fx-text-fill: white;"/>
            <Button text="Refresh" onAction="#loadExchangeLog"/>
        </HBox>

        <!-- TableView for Logs - Set to grow to fill remaining vertical space -->
        <TableView fx:id="exchangeLogTableView" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="colInvoiceNo" text="Invoice No"/>
                <TableColumn fx:id="colReturnItem" text="Returned Item"/>
                <TableColumn fx:id="colNewItem" text="New Item"/>
                <TableColumn fx:id="colDifference" text="Difference"/>
                <TableColumn fx:id="colDate" text="Date"/>
                <TableColumn fx:id="colCustomer" text="Customer"/>
                <TableColumn fx:id="colHandledBy" text="Handled By"/>
            </columns>
            <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
        </TableView>
    </VBox>
</HBox>
